{"ast":null,"code":"import _objectSpread from\"C:/Users/Natalia/Desktop/React course/burger-builder/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:/Users/Natalia/Desktop/React course/burger-builder/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Natalia/Desktop/React course/burger-builder/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/Natalia/Desktop/React course/burger-builder/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Natalia/Desktop/React course/burger-builder/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{connect}from\"react-redux\";import Auxiliar from\"../../hoc/Auxiliar/Auxiliar\";import Burger from\"../../components/Burger/Burger\";import BuildControls from\"../../components/Burger/BuildControls/BuildControls\";import Modal from\"../../components/UI/Modal/Modal\";import OrderSummary from\"../../components/Burger/OrderSummary/OrderSummary\";import Spinner from\"../../components/UI/Spinner/Spinner\";import withErrorHandler from\"../../hoc/withErrorHandler/withErrorHandler\";import axios from\"../../axios-orders\";import*as actions from\"../../store/actions/index\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var BurgerBuilder=/*#__PURE__*/function(_Component){_inherits(BurgerBuilder,_Component);var _super=_createSuper(BurgerBuilder);function BurgerBuilder(){var _this;_classCallCheck(this,BurgerBuilder);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={purchasing:false};_this.purchaseHandler=function(){if(_this.props.isAuthenticated){_this.setState({purchasing:true});}else{_this.props.onSetAuthRedirectPath(\"/checkout\");_this.props.history.push(\"/auth\");}};_this.purchaseCancelHandler=function(){_this.setState({purchasing:false});};_this.purchaseContinueHandler=function(){_this.props.onInitPurchase();_this.props.history.push(\"/checkout\");};return _this;}_createClass(BurgerBuilder,[{key:\"componentDidMount\",value:function componentDidMount(){this.props.onInitIngredients();}},{key:\"updatePurchaseState\",value:function updatePurchaseState(ingredients){var sum=Object.keys(ingredients).map(function(igKey){return ingredients[igKey];}).reduce(function(sum,el){return sum+el;},0);return sum>0;}},{key:\"render\",value:function render(){var disabledInfo=_objectSpread({},this.props.ings);for(var key in disabledInfo){disabledInfo[key]=disabledInfo[key]<=0;}var orderSummary=null;var burger=this.props.error?/*#__PURE__*/_jsx(\"p\",{children:\"Ingredients can't be loaded!\"}):/*#__PURE__*/_jsx(Spinner,{});if(this.props.ings){burger=/*#__PURE__*/_jsxs(Auxiliar,{children:[/*#__PURE__*/_jsx(Burger,{ingredients:this.props.ings}),/*#__PURE__*/_jsx(BuildControls,{ingredientAdded:this.props.onIngredientAdded,ingredientRemoved:this.props.onIngredientRemoved,disabled:disabledInfo,purchasable:this.updatePurchaseState(this.props.ings),ordered:this.purchaseHandler,isAuth:this.props.isAuthenticated,price:this.props.price})]});orderSummary=/*#__PURE__*/_jsx(OrderSummary,{ingredients:this.props.ings,price:this.props.price,purchaseCancelled:this.purchaseCancelHandler,purchaseContinued:this.purchaseContinueHandler});}// {salad: true, meat: false, ...}\nreturn/*#__PURE__*/_jsxs(Auxiliar,{children:[/*#__PURE__*/_jsx(Modal,{show:this.state.purchasing,modalClosed:this.purchaseCancelHandler,children:orderSummary}),burger]});}}]);return BurgerBuilder;}(Component);var mapStateToProps=function mapStateToProps(state){return{ings:state.burgerBuilder.ingredients,price:state.burgerBuilder.totalPrice,error:state.burgerBuilder.error,isAuthenticated:state.auth.token!==null};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{onIngredientAdded:function onIngredientAdded(ingName){return dispatch(actions.addIngredient(ingName));},onIngredientRemoved:function onIngredientRemoved(ingName){return dispatch(actions.removeIngredient(ingName));},onInitIngredients:function onInitIngredients(){return dispatch(actions.initIngredients());},onInitPurchase:function onInitPurchase(){return dispatch(actions.purchaseInit());},onSetAuthRedirectPath:function onSetAuthRedirectPath(path){return dispatch(actions.setAuthRedirectPath(path));}};};export default connect(mapStateToProps,mapDispatchToProps)(withErrorHandler(BurgerBuilder,axios));","map":{"version":3,"sources":["C:/Users/Natalia/Desktop/React course/burger-builder/src/containers/BurgerBuilder/BurgerBuilder.js"],"names":["React","Component","connect","Auxiliar","Burger","BuildControls","Modal","OrderSummary","Spinner","withErrorHandler","axios","actions","BurgerBuilder","state","purchasing","purchaseHandler","props","isAuthenticated","setState","onSetAuthRedirectPath","history","push","purchaseCancelHandler","purchaseContinueHandler","onInitPurchase","onInitIngredients","ingredients","sum","Object","keys","map","igKey","reduce","el","disabledInfo","ings","key","orderSummary","burger","error","onIngredientAdded","onIngredientRemoved","updatePurchaseState","price","mapStateToProps","burgerBuilder","totalPrice","auth","token","mapDispatchToProps","dispatch","ingName","addIngredient","removeIngredient","initIngredients","purchaseInit","path","setAuthRedirectPath"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport Auxiliar from \"../../hoc/Auxiliar/Auxiliar\";\r\nimport Burger from \"../../components/Burger/Burger\";\r\nimport BuildControls from \"../../components/Burger/BuildControls/BuildControls\";\r\nimport Modal from \"../../components/UI/Modal/Modal\";\r\nimport OrderSummary from \"../../components/Burger/OrderSummary/OrderSummary\";\r\nimport Spinner from \"../../components/UI/Spinner/Spinner\";\r\nimport withErrorHandler from \"../../hoc/withErrorHandler/withErrorHandler\";\r\nimport axios from \"../../axios-orders\";\r\nimport * as actions from \"../../store/actions/index\";\r\n\r\nexport class BurgerBuilder extends Component {\r\n  // constructor(props) {\r\n  //     super(props);\r\n  //     this.state = {...}\r\n  // }\r\n  state = {\r\n    purchasing: false,\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.props.onInitIngredients();\r\n  }\r\n\r\n  updatePurchaseState(ingredients) {\r\n    const sum = Object.keys(ingredients)\r\n      .map((igKey) => {\r\n        return ingredients[igKey];\r\n      })\r\n      .reduce((sum, el) => {\r\n        return sum + el;\r\n      }, 0);\r\n    return sum > 0;\r\n  }\r\n\r\n  purchaseHandler = () => {\r\n    if (this.props.isAuthenticated) {\r\n      this.setState({ purchasing: true });\r\n    } else {\r\n      this.props.onSetAuthRedirectPath(\"/checkout\");\r\n      this.props.history.push(\"/auth\");\r\n    }\r\n  };\r\n\r\n  purchaseCancelHandler = () => {\r\n    this.setState({ purchasing: false });\r\n  };\r\n\r\n  purchaseContinueHandler = () => {\r\n    this.props.onInitPurchase();\r\n    this.props.history.push(\"/checkout\");\r\n  };\r\n\r\n  render() {\r\n    const disabledInfo = {\r\n      ...this.props.ings,\r\n    };\r\n    for (let key in disabledInfo) {\r\n      disabledInfo[key] = disabledInfo[key] <= 0;\r\n    }\r\n    let orderSummary = null;\r\n    let burger = this.props.error ? (\r\n      <p>Ingredients can't be loaded!</p>\r\n    ) : (\r\n      <Spinner />\r\n    );\r\n\r\n    if (this.props.ings) {\r\n      burger = (\r\n        <Auxiliar>\r\n          <Burger ingredients={this.props.ings} />\r\n          <BuildControls\r\n            ingredientAdded={this.props.onIngredientAdded}\r\n            ingredientRemoved={this.props.onIngredientRemoved}\r\n            disabled={disabledInfo}\r\n            purchasable={this.updatePurchaseState(this.props.ings)}\r\n            ordered={this.purchaseHandler}\r\n            isAuth={this.props.isAuthenticated}\r\n            price={this.props.price}\r\n          />\r\n        </Auxiliar>\r\n      );\r\n      orderSummary = (\r\n        <OrderSummary\r\n          ingredients={this.props.ings}\r\n          price={this.props.price}\r\n          purchaseCancelled={this.purchaseCancelHandler}\r\n          purchaseContinued={this.purchaseContinueHandler}\r\n        />\r\n      );\r\n    }\r\n    // {salad: true, meat: false, ...}\r\n    return (\r\n      <Auxiliar>\r\n        <Modal\r\n          show={this.state.purchasing}\r\n          modalClosed={this.purchaseCancelHandler}\r\n        >\r\n          {orderSummary}\r\n        </Modal>\r\n        {burger}\r\n      </Auxiliar>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    ings: state.burgerBuilder.ingredients,\r\n    price: state.burgerBuilder.totalPrice,\r\n    error: state.burgerBuilder.error,\r\n    isAuthenticated: state.auth.token !== null,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    onIngredientAdded: (ingName) => dispatch(actions.addIngredient(ingName)),\r\n    onIngredientRemoved: (ingName) =>\r\n      dispatch(actions.removeIngredient(ingName)),\r\n    onInitIngredients: () => dispatch(actions.initIngredients()),\r\n    onInitPurchase: () => dispatch(actions.purchaseInit()),\r\n    onSetAuthRedirectPath: (path) =>\r\n      dispatch(actions.setAuthRedirectPath(path)),\r\n  };\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(withErrorHandler(BurgerBuilder, axios));\r\n"]},"metadata":{},"sourceType":"module"}